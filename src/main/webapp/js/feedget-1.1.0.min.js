/*
 Feedget - RSS Feed reader jQuery Plugin
 v1.1.0

 author: palroj
 site: http://codecanyon.net/item/feedget-rss-reader/3546560
 */
(function (a, b) {
    a.fn.feedget = function (g) {
        var i = (function () {
            var p = document.createElement("div");

            function q(r) {
                if (r && typeof r === "string") {
                    r = r.replace(/<script[^>]*>([\S\s]*?)<\/script>/gmi, "");
                    r = r.replace(/<\/?\w(?:[^"'>]|"[^"]*"|'[^']*')*>/gmi, "");
                    p.innerHTML = r;
                    if (p.textContent === b) {
                        r = p.innerText;
                        p.innerText = ""
                    } else {
                        r = p.textContent;
                        p.textContent = ""
                    }
                }
                return r
            }

            return q
        })();
        var e = function (s, q) {
            var r = s.getUTCDate();
            var v = s.getMonth() + 1;
            var u = s.getFullYear();
            var p = s.getHours();
            var t = s.getMinutes();
            var w = s.getSeconds();
            q.year = (u.toString().length == 1 ? "0" : "") + u;
            q.month = (v.toString().length == 1 ? "0" : "") + v;
            q.day = (r.toString().length == 1 ? "0" : "") + r;
            q.hours = (p.toString().length == 1 ? "0" : "") + p;
            q.minutes = (t.toString().length == 1 ? "0" : "") + t;
            q.seconds = (w.toString().length == 1 ? "0" : "") + w
        };
        var n = function (r) {
            try {
                var p = a("<div>" + r + "</div>").find("img").first();
                if (a(p).length == 0) {
                    return""
                } else {
                    return a(p).attr("src")
                }
            } catch (q) {
                return""
            }
        };
        var k = function (v, x, s) {
            if (!s) {
                var u = x.find(".feedget-elements-container");
                var t = x.find(".feedget-body-container");
                var r = false;
                var p = 0;
                switch (v) {
                    case"up":
                    case"left":
                        p = parseInt(a(u).attr("data-current-element-id")) - 1;
                        break;
                    case"down":
                    case"right":
                        p = parseInt(a(u).attr("data-current-element-id")) + 1;
                        break
                }
                var q = x.find(".feedget-element[data-element-id=" + p + "]");
                s = true;
                var w = {};
                if (v == "up" || v == "down") {
                    w = {scrollTop:q.position().top - parseInt(u.css("padding-top"))}
                } else {
                    if (v == "left" || v == "right") {
                        w = {scrollLeft:q.position().left - parseInt(u.css("padding-left"))}
                    }
                }
                t.animate(w, 300, function () {
                    o(x);
                    s = false
                });
                u.attr("data-current-element-id", p)
            }
        };
        var o = function (w) {
            if (w !== b) {
                var q = w.attr("id");
                var v = w.find(".feedget-body-container");
                var u = v.find(".feedget-elements-container");
                var p = a("#" + q + " .up.arrow");
                if (!(v.scrollTop() > 0)) {
                    if (!p.hasClass("ui-button-disabled.ui-state-disabled")) {
                        p.removeClass("ui-state-hover");
                        p.button({disabled:true})
                    }
                } else {
                    p.button({disabled:false})
                }
                var t = a("#" + q + " .down.arrow");
                if (!(u.outerHeight(true) - v.scrollTop() > v.outerHeight(true))) {
                    if (!t.hasClass("ui-button-disabled.ui-state-disabled")) {
                        t.removeClass("ui-state-hover");
                        t.button({disabled:true})
                    }
                } else {
                    t.button({disabled:false})
                }
                var r = a("#" + q + " .left.arrow");
                if (!(v.scrollLeft() > 0)) {
                    if (!r.hasClass("ui-button-disabled.ui-state-disabled")) {
                        r.removeClass("ui-state-hover");
                        r.button({disabled:true})
                    }
                } else {
                    r.button({disabled:false})
                }
                var s = a("#" + q + " .right.arrow");
                if (!(u.outerWidth(true) - v.scrollLeft() > v.outerWidth(true))) {
                    if (!s.hasClass("ui-button-disabled.ui-state-disabled")) {
                        s.removeClass("ui-state-hover");
                        s.button({disabled:true})
                    }
                } else {
                    s.button({disabled:false})
                }
            }
        };
        var h = {direction:"vertical", entries:10, images:true, fulltext:false, buttons:true, facebook:true, twitter:true, reverse:false};
        var g = a.extend(h, g);
        var f = this;
        var j = false;
        var c = false;
        if (typeof jQuery.ui != "undefined" && /[1-9]\.[7-9].[1-9]/.test(a.ui.version)) {
            c = true
        }
        f.each(function () {
            a(this).css("text-align", "center");
            var p = a("<img>").addClass("feedget-loading").attr("src", g.loadingImg).appendTo(a(this))
        });
        var d = Date.parse(new Date());
        var m = g.feed;
        if (g.feed.indexOf("?") == -1) {
            m += "?x=" + d
        } else {
            m += "&x=" + d
        }
        var m = g.feed;
        var l = "http://ajax.googleapis.com/ajax/services/feed/load?v=1.0&callback=?&num=" + g.entries + "&q=" + encodeURIComponent(m);
        a.getJSON(l, function (p) {
            f.each(function (E) {
                var B = a(this);
                var C = B.attr("id");
                if (B.attr("id") === b) {
                    var G = "feedget" + E;
                    B.attr("id", G)
                }
                var C = B.attr("id");
                a("#" + C + " .arrow").die("click");
                B.empty();
                B.addClass("feedget-container").addClass(g.direction).addClass("ui-widget").css("overflow", "hidden").css("position", "relative");
                B.find(".feedget-loading").hide();
                if (p.responseData == null) {
                    errorEl = a("<span>").addClass("feedget-error").text(p.responseDetails).appendTo(B);
                    return false
                }
                var y = a("<div>").addClass("feedget-header-container").addClass("ui-widget-header");
                B.prepend(y);
                var D = a("<div>").addClass("feedget-header-title").text(i(p.responseData.feed.title)).appendTo(y);
                var F = a("<div>").addClass("feedget-header-description").text(i(p.responseData.feed.description)).appendTo(y);
                var H = a("<div>").addClass("feedget-body-container").addClass("ui-widget-content");
                var A = a("<div>").addClass("feedget-elements-container").css("position", "relative").attr("data-current-element-id", "0");
                H.append(A);
                if (g.direction == "horizontal") {
                    H.css("overflow-x", "auto");
                    H.css("overflow-y", "hidden")
                } else {
                    H.css("overflow-y", "auto");
                    H.css("overflow-x", "hidden")
                }
                a.each(p.responseData.feed.entries, function (Y) {
                    var ab = i(p.responseData.feed.entries[Y].title);
                    var Q = p.responseData.feed.entries[Y].link;
                    var aa = new Date(p.responseData.feed.entries[Y].publishedDate);
                    var S = i(p.responseData.feed.entries[Y].contentSnippet);
                    var U = i(p.responseData.feed.entries[Y].content);
                    var P = (g.fulltext ? U : S);
                    var O = {year:"", month:"", day:"", hours:"", minutes:"", seconds:""};
                    e(aa, O);
                    var N;
                    if (g.reverse) {
                        N = a("<div>").prependTo(A).addClass("feedget-element").attr("data-element-id", Y)
                    } else {
                        N = a("<div>").appendTo(A).addClass("feedget-element").attr("data-element-id", Y)
                    }
                    var X = a("<div>").addClass("feedget-element-header");
                    X.appendTo(N);
                    var K = a("<span>").addClass("feedget-element-title");
                    var Z = a("<a>").attr("href", Q).attr("target", "_blank").text(ab).appendTo(K);
                    var R = a("<span>").addClass("feedget-element-date").text(O.year + "/" + O.month + "/" + O.day + " - " + O.hours + ":" + O.minutes + ":" + O.seconds);
                    X.append(K).append(R);
                    if (g.images) {
                        var W = n(p.responseData.feed.entries[Y].content);
                        if (W != "") {
                            var M = a("<img>").attr("src", W).removeAttr("height").removeAttr("width").addClass("feedget-element-image").appendTo(N)
                        }
                    }
                    var V = a("<span>").addClass("feedget-element-text").text(P).appendTo(N);
                    if (g.facebook || g.twitter) {
                        var T = a("<div>").addClass("feedget-element-social").appendTo(N);
                        if (g.facebook) {
                            var L = a("<div>").addClass("feedget-element-facebook").html('<iframe src="//www.facebook.com/plugins/like.php?href=' + Q + '&amp;send=false&amp;layout=button_count&amp;width=100&amp;show_faces=false&amp;action=like&amp;colorscheme=light&amp;font&amp;height=21" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:100px; height:21px;" allowtransparency="true"></iframe>').appendTo(T)
                        }
                        if (g.twitter) {
                            var J = a("<div>").addClass("feedget-element-twitter").html('<a href="https://twitter.com/share" class="twitter-share-button" data-width="1" data-url="' + Q + '">Tweet</a><script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0];if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src="//platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");<\/script>').appendTo(T)
                        }
                    }
                });
                B.append(H);
                if (c && g.buttons) {
                    if (g.direction == "vertical") {
                        var u = a("<div>").addClass(C + " up arrow").attr("data-direction", "up").button({disabled:true, text:false, icons:{primary:"ui-icon-carat-1-n"}});
                        var z = a("<div>").addClass(C + " down arrow").attr("data-direction", "down").button({text:false, icons:{primary:"ui-icon-carat-1-s"}});
                        y.append(u).append(z)
                    } else {
                        var s = a("<div>").addClass(C + " left arrow").attr("data-direction", "left").button({disabled:true, text:false, icons:{primary:"ui-icon-carat-1-w"}});
                        var w = a("<div>").addClass(C + " right arrow").attr("data-direction", "right").button({text:false, icons:{primary:"ui-icon-carat-1-e"}});
                        y.append(s).append(w)
                    }
                }
                if (g.direction == "horizontal") {
                    var t = p.responseData.feed.entries.length * B.find(".feedget-element").outerWidth(true);
                    A.width(t);
                    var v = B.find(".feedget-element").outerHeight(true) - B.find(".feedget-element").height();
                    var x = B.innerHeight() - y.outerHeight(true);
                    if (t < B.width()) {
                        t = B.width()
                    }
                    var I = parseInt(A.css("padding-top"));
                    var q = parseInt(A.css("padding-top"));
                    H.height(parseInt(x - (2 * parseFloat(H.css("borderTopWidth")))));
                    if (A.width() > B.width()) {
                        A.height(H[0].clientHeight - I - q);
                        B.find(".feedget-element").height(H[0].clientHeight - I - q - v)
                    } else {
                        if (g.buttons) {
                            a("#" + C + " .arrow").button({disabled:true})
                        }
                        A.height(x - I - q);
                        B.find(".feedget-element").height(x - I - q - v)
                    }
                } else {
                    var r = B.width();
                    if (!(A.height() > B.height())) {
                        if (g.buttons) {
                            a("#" + C + " .arrow").css("opacity", "0.2");
                            a("#" + C + " .arrow").die("click")
                        }
                    }
                    H.height(parseInt(B.height() - y.outerHeight(true) - (2 * parseFloat(H.css("borderTopWidth")))))
                }
                if (g.twitter) {
                    a.getScript("http://platform.twitter.com/widgets.js", function () {
                        twttr.widgets.load()
                    })
                }
                a(document).on("click", "#" + C + " .arrow", function (J) {
                    k(a(this).data("direction"), B, j)
                });
                a("#" + C + " .feedget-body-container").scroll(function (O) {
                    if (!j) {
                        var N = a(this);
                        var M = N.find(".feedget-elements-container");
                        var K = a("#" + C + " .feedget-element").filter(function (P) {
                            if (g.direction == "vertical") {
                                return a(this).offset().top >= N.offset().top && a(this).offset().top <= N.offset().top + N.height()
                            } else {
                                return a(this).offset().left >= N.offset().left && a(this).offset().left <= N.offset().left + N.width()
                            }
                        });
                        if (K.length) {
                            var J = a(K).first();
                            var L = J.data("element-id");
                            a("#" + C + " .feedget-elements-container").attr("data-current-element-id", L)
                        }
                        o(B)
                    }
                })
            })
        }, "jsonp");
        a(document).on("mouseenter", ".feedget-element", function (p) {
            a(this).siblings().each(function () {
                a(this).stop();
                a(this).animate({opacity:0.2}, 200, function () {
                })
            })
        });
        a(document).on("mouseleave", ".feedget-element", function (p) {
            a(this).siblings().each(function () {
                a(this).stop();
                a(this).animate({opacity:1}, 200, function () {
                })
            })
        });
        return this
    }
})(jQuery);